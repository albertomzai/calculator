{
  "files": [
    {
      "filename": "docs/backend_documentation.md",
      "action": "create_or_update",
      "code": [
        "# Visión General del Proyecto",
        "",
        "Este proyecto es una **calculadora de expresiones matemáticas** expuesta a través de una API RESTful construida con Flask. La lógica principal se encuentra en el archivo `routes.py`, donde se parsea y evalúa la expresión recibida mediante el módulo `ast` para garantizar que solo se ejecuten operaciones aritméticas seguras.",
        "",
        "El punto de entrada del servidor es `app.py`, que importa la función `create_app`. Esta fábrica inicializa la aplicación Flask, registra la blueprint `api_bp` y sirve el archivo estático `index.html` desde la carpeta `frontend` cuando se accede a `/`.",
        "",
        "# Arquitectura del Sistema",
        "",
        "La arquitectura sigue un patrón **microservicio ligero**: una única aplicación Flask que expone una API REST y sirve archivos estáticos. No hay bases de datos ni servicios externos; todo el procesamiento ocurre en memoria.",
        "",
        "| Componente | Responsabilidad | Tecnologías |",
        "|------------|-----------------|-------------|",
        "| `app.py`   | Punto de entrada, creación de la app | Flask |",
        "| `routes.py` | Lógica de cálculo y validación | Flask, ast |",
        "| `__init__.py` | Configuración de blueprints y rutas estáticas | Flask |",
        "",
        "El flujo de solicitud pasa por la blueprint `/api`, donde se valida el JSON y se devuelve un objeto JSON con el resultado o un error.",
        "",
        "# Endpoints de la API",
        "",
        "## POST /api/calculate",
        "",
        "### Descripción",
        "- Calcula una expresión matemática segura enviada en el cuerpo del request.",
        "",
        "### Request",
        "",
        "```http",
        "POST /api/calculate HTTP/1.1",
        "Content-Type: application/json",
        "",
        "{",
        '  "expression": "2 + 3 * (4 - 1)"',
        "}"
        "```",
        "",
        "### Response",
        "",
        "- **200 OK** con el resultado:",
        "",
        "```json",
        "{ \"result\": 11 }",
        "```",
        "",
        "- **400 Bad Request** si `expression` no es una cadena:",
        "",
        "```json",
        "{ \"error\": \"'expression' must be a string\" }",
        "```",
        "",
        "- **422 Unprocessable Entity** en caso de errores de evaluación (división por cero, sintaxis inválida):",
        "",
        "```json",
        "{ \"error\": \"division by zero\" }",
        "```",
        "",
        "# Instrucciones de Instalación y Ejecución",
        "",
        "1. **Clonar el repositorio**:",
        "",
        "   ```bash",
        "   git clone https://github.com/tu_usuario/tu_repositorio.git",
        "   cd tu_repositorio",
        "   ```",
        "",
        "2. **Crear un entorno virtual** (recomendado):",
        "",
        "   ```bash",
        "   python -m venv .venv",
        "   source .venv/bin/activate  # Windows: .\\.venv\\Scripts\\activate",
        "   ```",
        "",
        "3. **Instalar dependencias**:",
        "",
        "   ```bash",
        "   pip install -r requirements.txt",
        "   ```",
        "",
        "4. **Ejecutar la aplicación**:",
        "",
        "   ```bash",
        "   export FLASK_APP=app.py  # Windows: set FLASK_APP=app.py",
        "   flask run",
        "   ```",
        "",
        "5. **Probar el endpoint** (ejemplo con curl):",
        "",
        "   ```bash",
        "   curl -X POST http://127.0.0.1:5000/api/calculate \\",
        "     -H \"Content-Type: application/json\" \\",
        "     -d '{\"expression\": \"5 * (2 + 3)\"}'",
        "   ```",
        "",
        "# Flujo de Datos Clave",
        "",
        "```mermaid",
        "sequenceDiagram",
        "    participant Client as Cliente",
        "    participant API as /api/calculate",
        "    participant Eval as _eval_expr",
        "",
        "    Client->>API: POST {\"expression\": \"2+3*4\"}",
        "    API->>Eval: parse(expr)",
        "    Eval->>Eval: evaluate AST recursively",
        "    Eval-->>API: result = 14",
        "    API-->>Client: {\"result\": 14}",
        "```",
        "",
        "# Extensiones Futuras (Opcional)",
        "",
        "- **Persistencia**: Añadir una capa de almacenamiento para historial de cálculos.",
        "- **Autenticación**: Implementar JWT para proteger el endpoint.",
        "- **Validaciones avanzadas**: Soportar funciones trigonométricas y constantes matemáticas.",
        "- **Dockerización**: Empaquetar la aplicación en un contenedor Docker para despliegue más sencillo."
      ]
    }
  ]
}